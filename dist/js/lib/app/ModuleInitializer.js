"use strict";
var Promise = require("bluebird");
var StaticLogger_1 = require("../../components/logs/StaticLogger");
var ModuleNames_1 = require("../config/ModuleNames");
var ModulesLoader_1 = require("../module/ModulesLoader");
var ModuleInitializer = (function () {
    function ModuleInitializer() {
    }
    ModuleInitializer.prototype.initialize = function (application) {
        this.application = application;
        this.config = this.application.config;
        this.moduleLoader = new ModulesLoader_1.default(this.config.packageJson, this.config.moduleNameInPackageJson, this.config.moduleAppFileNameInPackageJson, this.config.moduleDependenciesInPackageJson);
        var defer = Promise.defer();
        this.application.resolve(ModuleNames_1.default.EXPRESS_APP_MODULE, this.bootstrapModules.bind(this, defer));
        return defer.promise;
    };
    ModuleInitializer.prototype.bootstrapModules = function (defer, app) {
        var _this = this;
        var disabledModules = this.config.disabledModules;
        var modulesToLoad = this.config.modulePaths;
        if (modulesToLoad.indexOf("node_modules") === -1) {
            modulesToLoad.push("node_modules");
        }
        var promises = [];
        if (modulesToLoad && modulesToLoad.length > 0) {
            modulesToLoad.forEach(function (path) {
                promises.push(_this.moduleLoader.loadModule(_this.application.modules, disabledModules, path));
            });
        }
        return Promise.all(promises)
            .then(this.allModulesLoaded.bind(this, app, defer))
            .catch(function (error) {
            StaticLogger_1.default.error("Error while loading modules: " + error);
            defer.resolve(false);
        });
    };
    ModuleInitializer.prototype.allModulesLoaded = function (app, defer) {
        var _this = this;
        app.use(this.config.url.modules, function (req, res) {
            res.json(_this.application.exportableModules);
        });
        app.use(this.config.url.allModules, function (req, res) {
            res.json(Object.keys(_this.application.resolved));
        });
        var modules = this.application.modules;
        if (!modules.unresolved.empty()) {
            throw "Can not start. There are packages with unresolved dependencies: "
                + modules.listOfUnresolved();
        }
        this.enableModules(defer);
    };
    ModuleInitializer.prototype.enableModules = function (defer) {
        var _this = this;
        var defers = [];
        this.application.modules.traverse(this.moduleActivator.bind(this, defers));
        Promise.all(defers).done(function () {
            _this.application.modules.traverse(_this.moduleRegistrator.bind(_this));
            defer.resolve(true);
        });
    };
    ModuleInitializer.prototype.moduleActivator = function (defers, loadedModule) {
        if (!loadedModule) {
            return;
        }
        var defer = Promise.defer();
        defers.push(defer);
        loadedModule.load();
        this.application.resolve(loadedModule.name, defer.resolve.bind(defer));
    };
    ModuleInitializer.prototype.moduleRegistrator = function (loadedModule) {
        if (!loadedModule) {
            return;
        }
        this.application.exportableModules.push({
            name: loadedModule.name,
            version: loadedModule.version
        });
    };
    return ModuleInitializer;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = ModuleInitializer;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9hcHAvTW9kdWxlSW5pdGlhbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQVksT0FBTyxXQUFNLFVBQVUsQ0FBQyxDQUFBO0FBR3BDLDZCQUF5QixvQ0FBb0MsQ0FBQyxDQUFBO0FBQzlELDRCQUF3Qix1QkFBdUIsQ0FBQyxDQUFBO0FBRWhELDhCQUEwQix5QkFBeUIsQ0FBQyxDQUFBO0FBSXBEO0lBQUE7SUE0RUEsQ0FBQztJQXZFRyxzQ0FBVSxHQUFWLFVBQVcsV0FBOEI7UUFDckMsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDL0IsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQztRQUN0QyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksdUJBQWEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFDekQsSUFBSSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsRUFDbkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyw4QkFBOEIsRUFDMUMsSUFBSSxDQUFDLE1BQU0sQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1FBQ2pELElBQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUM5QixJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxxQkFBVyxDQUFDLGtCQUFrQixFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDbEcsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUM7SUFDekIsQ0FBQztJQUVPLDRDQUFnQixHQUF4QixVQUF5QixLQUFxQixFQUFFLEdBQW9CO1FBQXBFLGlCQWtCQztRQWpCRyxJQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQztRQUNwRCxJQUFJLGFBQWEsR0FBa0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUM7UUFDM0Qs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Q0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7WUFBQyxNQUFNLENBQUM7UUFBQyxDQUFDO1FBQzlCLElBQU0sS0FBSyxHQUFtQixPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDOUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQixZQUFZLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUFFTyw2Q0FBaUIsR0FBekIsVUFBMEIsWUFBNkI7UUFDbkQsRUFBRSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1lBQUMsTUFBTSxDQUFDO1FBQUMsQ0FBQztRQUM5QixJQUFJLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQztZQUNwQyxJQUFJLEVBQUUsWUFBWSxDQUFDLElBQUk7WUFDdkIsT0FBTyxFQUFFLFlBQVksQ0FBQyxPQUFPO1NBQ2hDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFDTCx3QkFBQztBQUFELENBNUVBLEFBNEVDLElBQUE7QUE1RUQ7bUNBNEVDLENBQUEiLCJmaWxlIjoibGliL2FwcC9Nb2R1bGVJbml0aWFsaXplci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFByb21pc2UgZnJvbSBcImJsdWViaXJkXCI7XG5pbXBvcnQgKiBhcyBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgKiBhcyBUeXBlcyBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy90eXBlcy9UeXBlc1wiO1xuaW1wb3J0IFN0YXRpY0xvZ2dlciBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9sb2dzL1N0YXRpY0xvZ2dlclwiO1xuaW1wb3J0IE1vZHVsZU5hbWVzIGZyb20gXCIuLi9jb25maWcvTW9kdWxlTmFtZXNcIjtcbmltcG9ydCBEZXBlbmRhbnRNb2R1bGUgZnJvbSBcIi4uL21vZHVsZS9EZXBlbmRhbnRNb2R1bGVcIjtcbmltcG9ydCBNb2R1bGVzTG9hZGVyIGZyb20gXCIuLi9tb2R1bGUvTW9kdWxlc0xvYWRlclwiO1xuaW1wb3J0IHsgSUNvbmZpZyB9IGZyb20gXCIuLi9jb25maWcvSUNvbmZpZ1wiO1xuaW1wb3J0IHsgSUFwcEluaXRpYWxpemVyIH0gZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvaW50aWFsaXplci9JQXBwSW5pdGlhbGl6ZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kdWxlSW5pdGlhbGl6ZXIgaW1wbGVtZW50cyBJQXBwSW5pdGlhbGl6ZXIge1xuICAgIHByaXZhdGUgYXBwbGljYXRpb246IFR5cGVzLkFwcGxpY2F0aW9uO1xuICAgIHByaXZhdGUgY29uZmlnOiBJQ29uZmlnO1xuICAgIHByaXZhdGUgbW9kdWxlTG9hZGVyOiBNb2R1bGVzTG9hZGVyO1xuXG4gICAgaW5pdGlhbGl6ZShhcHBsaWNhdGlvbjogVHlwZXMuQXBwbGljYXRpb24pOiBQcm9taXNlPHt9PiB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5jb25maWcgPSB0aGlzLmFwcGxpY2F0aW9uLmNvbmZpZztcbiAgICAgICAgdGhpcy5tb2R1bGVMb2FkZXIgPSBuZXcgTW9kdWxlc0xvYWRlcih0aGlzLmNvbmZpZy5wYWNrYWdlSnNvbixcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLm1vZHVsZU5hbWVJblBhY2thZ2VKc29uLFxuICAgICAgICAgICAgdGhpcy5jb25maWcubW9kdWxlQXBwRmlsZU5hbWVJblBhY2thZ2VKc29uLFxuICAgICAgICAgICAgdGhpcy5jb25maWcubW9kdWxlRGVwZW5kZW5jaWVzSW5QYWNrYWdlSnNvbik7XG4gICAgICAgIGNvbnN0IGRlZmVyID0gUHJvbWlzZS5kZWZlcigpO1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLnJlc29sdmUoTW9kdWxlTmFtZXMuRVhQUkVTU19BUFBfTU9EVUxFLCB0aGlzLmJvb3RzdHJhcE1vZHVsZXMuYmluZCh0aGlzLCBkZWZlcikpO1xuICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJvb3RzdHJhcE1vZHVsZXMoZGVmZXI6IFR5cGVzLlJlc29sdmVyLCBhcHA6IGV4cHJlc3MuRXhwcmVzcyk6IFByb21pc2U8e30+IHtcbiAgICAgICAgY29uc3QgZGlzYWJsZWRNb2R1bGVzID0gdGhpcy5jb25maWcuZGlzYWJsZWRNb2R1bGVzO1xuICAgICAgICBsZXQgbW9kdWxlc1RvTG9hZDogQXJyYXk8c3RyaW5nPiA9IHRoaXMuY29uZmlnLm1vZHVsZVBhdGhzO1xuICAgICAgICBpZiAobW9kdWxlc1RvTG9hZC5pbmRleE9mKFwibm9kZV9tb2R1bGVzXCIpID09PSAtMSkge1xuICAgICAgICAgICAgbW9kdWxlc1RvTG9hZC5wdXNoKFwibm9kZV9tb2R1bGVzXCIpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBwcm9taXNlczogQXJyYXk8UHJvbWlzZTx7fT4+ID0gW107XG4gICAgICAgIGlmIChtb2R1bGVzVG9Mb2FkICYmIG1vZHVsZXNUb0xvYWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbW9kdWxlc1RvTG9hZC5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLm1vZHVsZUxvYWRlci5sb2FkTW9kdWxlKHRoaXMuYXBwbGljYXRpb24ubW9kdWxlcywgZGlzYWJsZWRNb2R1bGVzLCBwYXRoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpXG4gICAgICAgIC50aGVuKHRoaXMuYWxsTW9kdWxlc0xvYWRlZC5iaW5kKHRoaXMsIGFwcCwgZGVmZXIpKVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBTdGF0aWNMb2dnZXIuZXJyb3IoXCJFcnJvciB3aGlsZSBsb2FkaW5nIG1vZHVsZXM6IFwiICsgZXJyb3IpO1xuICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYWxsTW9kdWxlc0xvYWRlZChhcHA6IGV4cHJlc3MuRXhwcmVzcywgZGVmZXI6IFR5cGVzLlJlc29sdmVyKSB7XG4gICAgICAgIGFwcC51c2UodGhpcy5jb25maWcudXJsLm1vZHVsZXMsIChyZXE6IGV4cHJlc3MuUmVxdWVzdCwgcmVzOiBleHByZXNzLlJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICByZXMuanNvbih0aGlzLmFwcGxpY2F0aW9uLmV4cG9ydGFibGVNb2R1bGVzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGFwcC51c2UodGhpcy5jb25maWcudXJsLmFsbE1vZHVsZXMsIChyZXE6IGV4cHJlc3MuUmVxdWVzdCwgcmVzOiBleHByZXNzLlJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICByZXMuanNvbihPYmplY3Qua2V5cyh0aGlzLmFwcGxpY2F0aW9uLnJlc29sdmVkKSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBtb2R1bGVzID0gdGhpcy5hcHBsaWNhdGlvbi5tb2R1bGVzO1xuICAgICAgICBpZiAoIW1vZHVsZXMudW5yZXNvbHZlZC5lbXB0eSgpKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkNhbiBub3Qgc3RhcnQuIFRoZXJlIGFyZSBwYWNrYWdlcyB3aXRoIHVucmVzb2x2ZWQgZGVwZW5kZW5jaWVzOiBcIlxuICAgICAgICAgICAgICAgICsgbW9kdWxlcy5saXN0T2ZVbnJlc29sdmVkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbmFibGVNb2R1bGVzKGRlZmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGVuYWJsZU1vZHVsZXMoZGVmZXI6IFR5cGVzLlJlc29sdmVyKSB7XG4gICAgICAgIGxldCBkZWZlcnM6IEFycmF5PFR5cGVzLlJlc29sdmVyPiA9IFtdO1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLm1vZHVsZXMudHJhdmVyc2UodGhpcy5tb2R1bGVBY3RpdmF0b3IuYmluZCh0aGlzLCBkZWZlcnMpKTtcbiAgICAgICAgUHJvbWlzZS5hbGwoZGVmZXJzKS5kb25lKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb24ubW9kdWxlcy50cmF2ZXJzZSh0aGlzLm1vZHVsZVJlZ2lzdHJhdG9yLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgZGVmZXIucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBtb2R1bGVBY3RpdmF0b3IoZGVmZXJzOiBBcnJheTxUeXBlcy5SZXNvbHZlcj4sIGxvYWRlZE1vZHVsZTogRGVwZW5kYW50TW9kdWxlKSB7XG4gICAgICAgIGlmICghbG9hZGVkTW9kdWxlKSB7IHJldHVybjsgfVxuICAgICAgICBjb25zdCBkZWZlcjogVHlwZXMuUmVzb2x2ZXIgPSBQcm9taXNlLmRlZmVyKCk7XG4gICAgICAgIGRlZmVycy5wdXNoKGRlZmVyKTtcbiAgICAgICAgbG9hZGVkTW9kdWxlLmxvYWQoKTtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbi5yZXNvbHZlKGxvYWRlZE1vZHVsZS5uYW1lLCBkZWZlci5yZXNvbHZlLmJpbmQoZGVmZXIpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG1vZHVsZVJlZ2lzdHJhdG9yKGxvYWRlZE1vZHVsZTogRGVwZW5kYW50TW9kdWxlKSB7XG4gICAgICAgIGlmICghbG9hZGVkTW9kdWxlKSB7IHJldHVybjsgfVxuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmV4cG9ydGFibGVNb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgbmFtZTogbG9hZGVkTW9kdWxlLm5hbWUsXG4gICAgICAgICAgICB2ZXJzaW9uOiBsb2FkZWRNb2R1bGUudmVyc2lvblxuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
